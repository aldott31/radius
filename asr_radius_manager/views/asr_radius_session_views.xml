<?xml version="1.0" encoding="UTF-8"?>
<odoo>

  <!-- âœ… WORKING LIST VIEW -->
  <record id="view_asr_radius_session_list" model="ir.ui.view">
    <field name="name">asr.radius.session.list</field>
    <field name="model">asr.radius.session</field>
    <field name="arch" type="xml">
      <list string="RADIUS Sessions"
            create="0"
            edit="0"
            delete="0"
            default_order="acctstarttime desc">
        <field name="username"/>
        <field name="framedipaddress" string="IP Address"/>
        <field name="nasipaddress" string="NAS"/>
        <field name="nasporttype" string="Type"/>
        <field name="acctstarttime" string="Start Time"/>
        <field name="duration_human" string="Duration"/>
        <field name="download_mb" string="Download (MB)"/>
        <field name="upload_mb" string="Upload (MB)"/>
        <field name="total_mb" string="Total (MB)"/>
        <field name="acctstoptime" string="Stop Time" optional="hide"/>
      </list>
    </field>
  </record>

  <!-- Form View -->
  <record id="view_asr_radius_session_form" model="ir.ui.view">
    <field name="name">asr.radius.session.form</field>
    <field name="model">asr.radius.session</field>
    <field name="arch" type="xml">
      <form string="Session Details" create="0" edit="0" delete="0">
        <sheet>
          <group>
            <group string="User Info">
              <field name="username"/>
              <field name="framedipaddress"/>
              <field name="radacctid"/>
            </group>
            <group string="NAS Info">
              <field name="nasipaddress"/>
              <field name="nasporttype"/>
              <field name="nasportid"/>
            </group>
          </group>
          <group>
            <group string="Session Times">
              <field name="acctstarttime"/>
              <field name="acctstoptime"/>
              <field name="duration_human"/>
              <field name="acctsessiontime" invisible="1"/>
            </group>
            <group string="Traffic">
              <field name="download_mb"/>
              <field name="upload_mb"/>
              <field name="total_mb"/>
              <field name="acctinputoctets" invisible="1"/>
              <field name="acctoutputoctets" invisible="1"/>
            </group>
          </group>
          <group>
            <field name="acctsessionid"/>
            <field name="acctterminatecause"/>
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <!-- Search View -->
  <record id="view_asr_radius_session_search" model="ir.ui.view">
    <field name="name">asr.radius.session.search</field>
    <field name="model">asr.radius.session</field>
    <field name="arch" type="xml">
      <search string="Search Sessions">
        <field name="username"/>
        <field name="framedipaddress"/>
        <field name="nasipaddress"/>

        <filter name="filter_active"
                string="Active Sessions"
                domain="[('acctstoptime','=',False)]"/>
        <filter name="filter_stopped"
                string="Stopped Sessions"
                domain="[('acctstoptime','!=',False)]"/>

        <group expand="0" string="Group By">
          <filter name="group_username"
                  string="Username"
                  context="{'group_by':'username'}"/>
          <filter name="group_nas"
                  string="NAS"
                  context="{'group_by':'nasipaddress'}"/>
        </group>
      </search>
    </field>
  </record>

  <!-- Action -->
  <record id="action_asr_radius_session" model="ir.actions.act_window">
    <field name="name">Sessions</field>
    <field name="res_model">asr.radius.session</field>
    <field name="view_mode">list,form</field>
    <field name="domain">[]</field>
    <field name="context">{}</field>
    <field name="limit">80</field>
    <field name="help" type="html">
      <p class="o_view_nocontent_smiling_face">No RADIUS sessions found</p>
      <p>Sessions appear here when users authenticate via PPPoE, HotSpot, etc. Data is read from <code>radacct</code>.</p>
    </field>
  </record>

  <menuitem id="menu_asr_radius_sessions"
            name="Sessions"
            parent="menu_asr_radius_root"
            action="action_asr_radius_session"
            sequence="25"/>

</odoo>